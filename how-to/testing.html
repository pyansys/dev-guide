
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Testing &#8212; PyAnsys Developer&#39;s Guide</title>
    
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/ansys_sphinx_theme.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    
        <link href="../_static/css/breadcrumbs.css" rel="stylesheet">
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/tabs.js"></script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Using continuous integration" href="continuous-integration.html" />
    <link rel="prev" title="Documenting" href="documenting.html" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="None">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    <img src="../_static/pyansys-logo-black-cropped.png" class="logo__image only-light" alt="Logo image">
    <img src="../_static/pyansys-logo-black-cropped.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../overview/index.html">
  Overview
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  How-To
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../packaging/index.html">
  Packaging style
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../coding-style/index.html">
  Coding style
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../doc-style/index.html">
  Documentation style
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../abstractions/index.html">
  Abstractions
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <span id="theme-switch" class="btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/pyansys/dev-guide" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    
    
        <div class="container-xl">
    <div class="row">
        <div class="col-12 col-md-3" id="breadcrumbs-spacer"></div>
        <div class="col-12 col-md-11 col-xl-9" id="breadcrumbs">
          
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
    
        <li class="nav-item nav-item-additional-breadcrumb"><a href="https://docs.pyansys.com/">PyAnsys</a> » </li>
    
    
        <li class="nav-item nav-item-0"><a href="../index.html">PyAnsys Developer's Guide</a> » </li>
    

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">How-To</a> » </li>
        <li class="nav-item nav-item-this"><a href="">Testing</a></li> 
      </ul>
    </div>
        </div>
  </div>
</div>
    


    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="setting-up.html">
   Setting up your development environment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="supporting-python-versions.html">
   Supporting Python versions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="contributing.html">
   Contributing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="packaging.html">
   Packaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="logging.html">
   Logging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="documenting.html">
   Documenting
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="continuous-integration.html">
   Using continuous integration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="releasing.html">
   Releasing and publishing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="repository-protection.html">
   Repository protection
  </a>
 </li>
</ul>

  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#testing-framework">
   Testing framework
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adding-testing-dependencies">
     Adding testing dependencies
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#organizing-test-files">
     Organizing test files
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#running-tests">
   Running tests
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#filtering-tests">
     Filtering tests
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#testing-methodology">
   Testing methodology
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#unit-testing">
     Unit testing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#integration-testing">
     Integration testing
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#wrapped-service-methods">
       Wrapped service methods
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#remote-method-invocation-testing">
       Remote method invocation testing
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#functional-testing">
     Functional testing
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#testing-code-coverage">
   Testing code coverage
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#configuring-code-coverage">
     Configuring code coverage
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#code-coverage-enforcement">
     Code coverage enforcement
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#testing-using-github-actions">
   Testing using GitHub Actions
  </a>
 </li>
</ul>

</nav>
    </div>
    
    <div class="toc-item">
      
    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section id="testing">
<h1>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">#</a></h1>
<p>Unit testing and integration testing are critical for the successful continuous
integration and delivery of any program or libraries belonging to the PyAnsys
project.</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Test-driven_development">Test Driven Development (TDD)</a> is the practice of writing unit tests before writing
production code. The benefit of this practice is that you know each new line of
code is working as soon as it is written. It’s easier to track down problems
because only a small amount of code has been implemented since the execution of the
last test. Furthermore, all test cases do not have to be implemented at once but
rather gradually as the code evolves. In 1993, Kent Beck developed TDD as part
of the Extreme Programming software development process.</p>
<p>You should follow TDD when developing your PyAnsys project. Examples
and best practices for unit tests follow.</p>
<section id="testing-framework">
<h2>Testing framework<a class="headerlink" href="#testing-framework" title="Permalink to this headline">#</a></h2>
<div align="center">
  <img width="50%"; src="https://docs.pytest.org/en/7.1.x/_static/pytest_logo_curves.svg">
</div><p>For consistency, PyAnsys tools and libraries should use either the <a class="reference external" href="https://docs.python.org/3/library/unittest.html">unittest</a> or <a class="reference external" href="https://docs.pytest.org/">pytest</a> framework for unit testing. This last framework is
recommended unless any constraint in your project prevents you from using it. As
described in <a class="reference internal" href="../packaging/structure.html#required-files"><span class="std std-ref">Required files</span></a>, unit tests should be placed in <a class="reference internal" href="../packaging/structure.html#the-tests-directory"><span class="std std-ref">The tests/ directory</span></a> in the library’s root directory.</p>
<section id="adding-testing-dependencies">
<h3>Adding testing dependencies<a class="headerlink" href="#adding-testing-dependencies" title="Permalink to this headline">#</a></h3>
<p>Requirements for testing dependencies should be included either in <a class="reference internal" href="../packaging/structure.html#the-setup-py-file"><span class="std std-ref">The setup.py file</span></a>, <a class="reference internal" href="../packaging/structure.html#the-pyproject-toml-file"><span class="std std-ref">The pyproject.toml file</span></a> or in a
<code class="docutils literal notranslate"><span class="pre">requirements_tests.txt</span></code> file. Only <code class="docutils literal notranslate"><span class="pre">pytest</span></code> and <code class="docutils literal notranslate"><span class="pre">pytest-cov</span></code>
must be specified as third-party dependencies because``unittest`` is included
in <a class="reference external" href="https://docs.python.org/3/library/">The Python Standard Library</a>.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-0-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-0-0-0" name="0-0" role="tab" tabindex="0">Flit</button><button aria-controls="panel-0-0-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-1" name="0-1" role="tab" tabindex="-1">Poetry</button><button aria-controls="panel-0-0-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-2" name="0-2" role="tab" tabindex="-1">Setuptools</button><button aria-controls="panel-0-0-3" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-3" name="0-3" role="tab" tabindex="-1">Requirements</button></div><div aria-labelledby="tab-0-0-0" class="sphinx-tabs-panel" id="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0"><div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[project.optional-dependencies]</span><span class="w"></span>
<span class="n">test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">    </span><span class="s">&quot;pytest&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="s">&quot;pytest-cov&quot;</span><span class="p">,</span><span class="w"></span>
<span class="p">]</span><span class="w"></span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-0-1" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-1" name="0-1" role="tabpanel" tabindex="0"><div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[tool.poetry.group.test.dependencies]</span><span class="w"></span>
<span class="n">pytest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;*&quot;</span><span class="w"></span>
<span class="n">pytest-cov</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;*&quot;</span><span class="w"></span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-0-2" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-2" name="0-2" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">setup</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ansys-&lt;product&gt;-&lt;library&gt;&quot;</span><span class="p">,</span>
    <span class="o">...</span><span class="p">,</span>
    <span class="n">extras_require</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;pytest&quot;</span><span class="p">,</span> <span class="s2">&quot;pytest-cov&quot;</span><span class="p">],</span>
    <span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-0-3" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-3" name="0-3" role="tabpanel" tabindex="0"><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pytest
pytest-cov
</pre></div>
</div>
</div></div>
<p>These dependencies can be installed using <code class="docutils literal notranslate"><span class="pre">pip</span></code>:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-1-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-1-1-0" name="1-0" role="tab" tabindex="0">From setup.py or pyproject.toml</button><button aria-controls="panel-1-1-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-1-1-1" name="1-1" role="tab" tabindex="-1">From requirements_tests.txt</button></div><div aria-labelledby="tab-1-1-0" class="sphinx-tabs-panel" id="panel-1-1-0" name="1-0" role="tabpanel" tabindex="0"><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>python -m pip install .[test]
</pre></div>
</div>
</div><div aria-labelledby="tab-1-1-1" class="sphinx-tabs-panel" hidden="true" id="panel-1-1-1" name="1-1" role="tabpanel" tabindex="0"><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>python -m pip install -r requirements_tests.txt
</pre></div>
</div>
</div></div>
</section>
<section id="organizing-test-files">
<h3>Organizing test files<a class="headerlink" href="#organizing-test-files" title="Permalink to this headline">#</a></h3>
<p>You must collect test files in <a class="reference internal" href="../packaging/structure.html#the-tests-directory"><span class="std std-ref">The tests/ directory</span></a>. To
guarantee that tests are run against the library source code, follow a <code class="docutils literal notranslate"><span class="pre">src/</span></code>
layout as explained in <a class="reference internal" href="../packaging/structure.html#the-src-directory"><span class="std std-ref">The src/ directory</span></a> rather than
having your Python library source located directly in the repository root directory.</p>
<p>This helps you to:</p>
<ul class="simple">
<li><p>Avoid testing the source of the repository rather than testing the installed package</p></li>
<li><p>Catch errors caused by files that might be missed by the installer, including any
C extensions or additional internal packages.</p></li>
</ul>
</section>
</section>
<section id="running-tests">
<h2>Running tests<a class="headerlink" href="#running-tests" title="Permalink to this headline">#</a></h2>
<p>Once you have installed <code class="docutils literal notranslate"><span class="pre">pytest</span></code>, you can execute the test suite with:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pytest -v tests/
</pre></div>
</div>
<section id="filtering-tests">
<h3>Filtering tests<a class="headerlink" href="#filtering-tests" title="Permalink to this headline">#</a></h3>
<p>To run a subset of all available tests, you can taking advantage
of the <code class="docutils literal notranslate"><span class="pre">keywords</span></code> and <code class="docutils literal notranslate"><span class="pre">markers</span></code> flags:</p>
<p><strong>Filtering tests by keywords</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pytest -k &#39;&lt;name pattern&gt;&#39;
pytest -k &#39;not &lt;name pattern&gt;&#39;
</pre></div>
</div>
<p><strong>Filtering tests by markers</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pytest -m slow
</pre></div>
</div>
<p>For more information about filtering tests, see <a class="reference external" href="https://docs.pytest.org/en/latest/example/markers.html">Working with Custom Markers</a> .</p>
</section>
</section>
<section id="testing-methodology">
<h2>Testing methodology<a class="headerlink" href="#testing-methodology" title="Permalink to this headline">#</a></h2>
<p>You should consider three levels of testing for your PyAnsys library: unit,
integration, and functional.</p>
<ul class="simple">
<li><p><a class="reference internal" href="#unit-testing"><span class="std std-ref">Unit testing</span></a> validates your library at the lowest possible level, isolating
individual classes and methods without any communication with other libraries
or services.</p></li>
<li><p><a class="reference internal" href="#integration-testing"><span class="std std-ref">Integration testing</span></a> validates that your library works in the context of an
app or software stack. For example, if your library extends or wraps
the features of an external service, you must test that service
in conjunction with your library. On GitHub, the ideal approach for this would
be to start your service via Docker and test accordingly. You should still be
testing at the individual class or method level, but you can now test how
multiple libraries or services interact. This is mandatory for testing APIs and
is preferred over mocking the service.</p></li>
<li><p><a class="reference internal" href="#functional-testing"><span class="std std-ref">Functional testing</span></a> should be used for validating workflows or long-running
examples. Assume that you have a library that wraps a CAD service. You
would validate that you can create complex geometry while directly interfacing
with the service. Functional tests are great at discovering edge cases that are
not normally found at the unit or integration level. However, functional testing
should be limited to only a handful of examples because these tend to be long
running and difficult to validate.</p></li>
</ul>
<p>Each PyAnsys project should have all three levels of testing implemented in its
testing framework. Consider implementing functional tests as examples within
your project’s documentation examples. This allows you to write helpful
user-facing tests while accomplishing functional testing.</p>
<section id="unit-testing">
<h3>Unit testing<a class="headerlink" href="#unit-testing" title="Permalink to this headline">#</a></h3>
<p>Unit testing tests at the lowest possible level, isolated
from other applications or libraries. For Python tool libraries like
<a class="reference external" href="https://github.com/ansys/ansys-tools-protoc-helper">ansys-tools-protoc-helper</a>, unit testing is sufficient to get high coverage
(&gt; 80%) of your library while actually testing the library.</p>
<p>These tests should be written to test a single method in isolation. For
example, if you have a method that deserializes chunks, the associated test
file would be:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-2-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-2-2-0" name="2-0" role="tab" tabindex="0">parse_chunks.py</button><button aria-controls="panel-2-2-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-2-2-1" name="2-1" role="tab" tabindex="-1">test_parse_chunks.py</button></div><div aria-labelledby="tab-2-2-0" class="sphinx-tabs-panel" id="panel-2-2-0" name="2-0" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">parse_chunks</span><span class="p">(</span><span class="n">chunks</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Deserialize gRPC chunks into a Numpy array.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    chunks : generator</span>
<span class="sd">        Generator from gRPC. Each chunk contains a bytes payload.</span>

<span class="sd">    dtype : np.dtype</span>
<span class="sd">        Numpy data type to interpert chunks as.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    array : np.ndarray</span>
<span class="sd">        Deserialized Numpy array.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">arrays</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunks</span><span class="p">:</span>
        <span class="n">arrays</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">chunk</span><span class="o">.</span><span class="n">payload</span><span class="p">,</span> <span class="n">ANSYS_VALUE_TYPE</span><span class="p">[</span><span class="n">chunk</span><span class="o">.</span><span class="n">value_type</span><span class="p">])</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">arrays</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-2-1" class="sphinx-tabs-panel" hidden="true" id="panel-2-2-1" name="2-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ansys.api.mapdl.v0</span> <span class="kn">import</span> <span class="n">ansys_kernel_pb2</span> <span class="k">as</span> <span class="n">anskernel</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pytest</span>

<span class="kn">from</span> <span class="nn">ansys.mapdl.core.common_grpc</span> <span class="kn">import</span> <span class="n">parse_chunks</span>

<span class="n">DEFAULT_CHUNKSIZE</span> <span class="o">=</span> <span class="mi">256</span><span class="o">*</span><span class="mi">1024</span>  <span class="c1"># 256 kB</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">sample_array</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Generate a non-trivial (n x 3) float array.&quot;&quot;&quot;</span>
    <span class="n">sz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">100000</span><span class="p">,</span> <span class="mi">200000</span><span class="p">)</span>
    <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">sz</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">array</span><span class="o">.</span><span class="n">nbytes</span> <span class="o">&gt;</span> <span class="n">DEFAULT_CHUNKSIZE</span>
    <span class="k">return</span> <span class="n">array</span>


<span class="k">def</span> <span class="nf">serialize_chunks</span><span class="p">(</span><span class="n">array</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Serialize an array into chunks.&quot;&quot;&quot;</span>
    <span class="c1"># convert to raw</span>
    <span class="n">raw</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()</span>
    <span class="n">value_type</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># float64</span>

    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">piece</span> <span class="o">=</span> <span class="n">raw</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">DEFAULT_CHUNKSIZE</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="n">DEFAULT_CHUNKSIZE</span>
        <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">piece</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">yield</span> <span class="n">anskernel</span><span class="o">.</span><span class="n">Chunk</span><span class="p">(</span><span class="n">payload</span><span class="o">=</span><span class="n">piece</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">length</span><span class="p">,</span> <span class="n">value_type</span><span class="o">=</span><span class="n">value_type</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">test_deserialize_chunks</span><span class="p">(</span><span class="n">sample_array</span><span class="p">):</span>
    <span class="n">parsed_array</span> <span class="o">=</span> <span class="n">parse_chunks</span><span class="p">(</span><span class="n">serialize_chunks</span><span class="p">(</span><span class="n">sample_array</span><span class="p">))</span>
    <span class="n">parsed_array</span> <span class="o">=</span> <span class="n">parsed_array</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">sample_array</span><span class="p">,</span> <span class="n">parsed_array</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<p>This assumes that you do not have a <code class="docutils literal notranslate"><span class="pre">serialize_chunks</span></code> function in your
library. If you did, you could exclude it from <code class="docutils literal notranslate"><span class="pre">test_parse_chunks.py</span></code>.</p>
</section>
<section id="integration-testing">
<h3>Integration testing<a class="headerlink" href="#integration-testing" title="Permalink to this headline">#</a></h3>
<p>This section explains <a class="reference internal" href="#wrapped-service-methods"><span class="std std-ref">Wrapped service methods</span></a> and <a class="reference internal" href="#remote-method-invocation-testing"><span class="std std-ref">Remote method invocation testing</span></a>.</p>
<section id="wrapped-service-methods">
<h4>Wrapped service methods<a class="headerlink" href="#wrapped-service-methods" title="Permalink to this headline">#</a></h4>
<p>Any PyAnsys library that provides features by wrapping a gRPC interface
should include tests of the gRPC methods exposed by the PROTO files and wrapped
by the Python library. They would not be expected to test the features of
the server but rather the APIs exposed by the server. For example, if testing
the gRPC method <code class="docutils literal notranslate"><span class="pre">GetNode</span></code>, then your integration test would test the wrapped
Python function. If the Python library wraps this gRPC method with a
<code class="docutils literal notranslate"><span class="pre">get_node</span></code> method, your test would be implemented within
<code class="docutils literal notranslate"><span class="pre">tests/test_nodes.py</span></code>:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-3-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-3-3-0" name="3-0" role="tab" tabindex="0">gRPC Code</button><button aria-controls="panel-3-3-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-3-3-1" name="3-1" role="tab" tabindex="-1">Python Code</button><button aria-controls="panel-3-3-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-3-3-2" name="3-2" role="tab" tabindex="-1">Unit Test</button></div><div aria-labelledby="tab-3-3-0" class="sphinx-tabs-panel" id="panel-3-3-0" name="3-0" role="tabpanel" tabindex="0"><div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">Node</span><span class="w"></span>
<span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="n">int32</span><span class="w">      </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="n">double</span><span class="w">     </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="n">double</span><span class="w">     </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="n">double</span><span class="w">     </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">NodeRequest</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="n">int32</span><span class="w">      </span><span class="n">num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">NodeResponse</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="n">Node</span><span class="w">       </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="n">service</span><span class="w"> </span><span class="n">SomeService</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">   </span><span class="n">rpc</span><span class="w"> </span><span class="n">GetNode</span><span class="p">(</span><span class="n">NodeRequest</span><span class="p">)</span><span class="w">  </span><span class="n">returns</span><span class="w"> </span><span class="p">(</span><span class="n">NodeResponse</span><span class="p">);</span><span class="w"></span>
<span class="w">   </span><span class="c1">// other methods</span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-3-1" class="sphinx-tabs-panel" hidden="true" id="panel-3-3-1" name="3-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ansys.product.service.v0</span> <span class="kn">import</span> <span class="n">service_pb2</span>

<span class="k">def</span> <span class="nf">get_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the coordinates of a node for a given index.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    index : int</span>
<span class="sd">        Index of the node.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple</span>
<span class="sd">        Coordinates of the node.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from ansys.product.service import SomeService</span>
<span class="sd">    &gt;&gt;&gt; srv = SomeService()</span>
<span class="sd">    &gt;&gt;&gt; srv.create_node(1, 4.5, 9.0, 3.2)</span>
<span class="sd">    &gt;&gt;&gt; node = srv.get_node(1)</span>
<span class="sd">    &gt;&gt;&gt; node</span>
<span class="sd">    (4.5, 9.0, 3.2)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">service_pb2</span><span class="o">.</span><span class="n">GetNode</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">resp</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">resp</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">resp</span><span class="o">.</span><span class="n">z</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-3-2" class="sphinx-tabs-panel" hidden="true" id="panel-3-3-2" name="3-2" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_get_node</span><span class="p">(</span><span class="n">srv</span><span class="p">):</span>
    <span class="n">srv</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="n">node_index</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">node_coord</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span>
    <span class="n">srv</span><span class="o">.</span><span class="n">create_node</span><span class="p">(</span><span class="n">node_index</span><span class="p">,</span> <span class="n">node_coord</span><span class="o">*</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">srv</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="n">node_index</span><span class="p">)</span> <span class="o">==</span> <span class="n">node_coord</span>
</pre></div>
</div>
</div></div>
<p>The goal of the unit test should be to test the API rather than the product or
service. In the case of <code class="docutils literal notranslate"><span class="pre">GetNode</span></code>, this method should have already
been tested when designing and developing the service.</p>
</section>
<section id="remote-method-invocation-testing">
<h4>Remote method invocation testing<a class="headerlink" href="#remote-method-invocation-testing" title="Permalink to this headline">#</a></h4>
<p>For a Remote Method Invocation (RMI)-like method, it is only
necessary to test the method with a basic case and potentially with any edge
cases. A RMI-like API might send and receive strings that are executed on the
server using a custom API or language only available within the context of the
service.</p>
<p>For example, if a method has a RMI service definition named <code class="docutils literal notranslate"><span class="pre">SendCommand()</span></code> and
a Python wrapping named <code class="docutils literal notranslate"><span class="pre">send_command</span></code>, the example test would be:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-4-4-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-4-4-0" name="4-0" role="tab" tabindex="0">gRPC Code</button><button aria-controls="panel-4-4-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-4-4-1" name="4-1" role="tab" tabindex="-1">Python Code</button><button aria-controls="panel-4-4-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-4-4-2" name="4-2" role="tab" tabindex="-1">Unit Test</button></div><div aria-labelledby="tab-4-4-0" class="sphinx-tabs-panel" id="panel-4-4-0" name="4-0" role="tabpanel" tabindex="0"><div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="n">message</span><span class="w"> </span><span class="n">SendCommand</span><span class="p">()</span><span class="w"></span>
</pre></div>
</div>
</div><div aria-labelledby="tab-4-4-1" class="sphinx-tabs-panel" hidden="true" id="panel-4-4-1" name="4-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">send_command</span><span class="p">(</span><span class="n">command</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Run a command on the remote server.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    command : str</span>
<span class="sd">        Command to run on the remote server.</span>

<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-4-4-2" class="sphinx-tabs-panel" hidden="true" id="panel-4-4-2" name="4-2" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_send_command</span><span class="p">(</span><span class="n">srv</span><span class="p">):</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">srv</span><span class="o">.</span><span class="n">send_command</span><span class="p">(</span><span class="s2">&quot;CREATE,1&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="s2">&quot;Created 1&quot;</span> <span class="ow">in</span> <span class="n">output</span>
</pre></div>
</div>
</div></div>
<p>Note that this test only validates that the command <code class="docutils literal notranslate"><span class="pre">&quot;CREATE,1&quot;</span></code> has been
received, executed, and sent back to the client. It does not validate all
commands. Running such a test is necessary only if there are edge cases, which
include characters that cannot be streamed or use long-running commands.</p>
</section>
</section>
<section id="functional-testing">
<h3>Functional testing<a class="headerlink" href="#functional-testing" title="Permalink to this headline">#</a></h3>
<p>Functional testing should test the Python library using scripts or examples
that are expected to be executed by the user. Unlike unit or integration
testing, functional tests are testing the library as a whole by calling
several methods to accomplish a task. You should run these tests only after unit
and integration testing is complete. Ideally, you should run them outside the
<code class="docutils literal notranslate"><span class="pre">pytest</span></code> framework while building documentation with <a class="reference external" href="https://sphinx-gallery.github.io/">sphinx-gallery</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Functional tests should not contribute to global library coverage. Testing
should always be done on individual functions or methods.</p>
</div>
</section>
</section>
<section id="testing-code-coverage">
<h2>Testing code coverage<a class="headerlink" href="#testing-code-coverage" title="Permalink to this headline">#</a></h2>
<p>Because Python is an interpreted language, syntax errors can only be
caught during the almost trivial compile times. Thus, developers of Python libraries
should aim to have high coverage for their libraries. Coverage is defined as parts
of the executable and usable source that are tested by unit tests. You can use
the <a class="reference external" href="https://pytest-cov.readthedocs.io/">pytest-cov</a> library to view the
coverage for your library.</p>
<section id="configuring-code-coverage">
<h3>Configuring code coverage<a class="headerlink" href="#configuring-code-coverage" title="Permalink to this headline">#</a></h3>
<p>If you do not configure code coverage properly, the resulting report does
not show the real scope covered by the test suite.</p>
<p>Assuming that a <code class="docutils literal notranslate"><span class="pre">PyAnsys</span></code> project follows <a class="reference internal" href="../packaging/structure.html#the-src-directory"><span class="std std-ref">The src/ directory</span></a> layout,
you must pass the following flag when <a class="reference internal" href="#running-tests"><span class="std std-ref">Running tests</span></a>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pytest --cov=ansys.&lt;product&gt;.&lt;library&gt; --cov-report=term tests/
</pre></div>
</div>
<p>This command tells <code class="docutils literal notranslate"><span class="pre">pytest-cov</span></code> to look for source code in the
<code class="docutils literal notranslate"><span class="pre">src/ansys/&lt;product&gt;</span></code> directory and generate a terminal report for all tests
located in <a class="reference internal" href="../packaging/structure.html#the-tests-directory"><span class="std std-ref">The tests/ directory</span></a>.</p>
<p>While 100% coverage is ideal, the law of diminishing returns applies to
the coverage of a Python library. Consequently, achieving 80-90% coverage is
often sufficient. For parts of your library that are difficult or impossible
to test, consider using <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">pragma:</span> <span class="pre">no</span> <span class="pre">cover</span></code> at the end of the method
definition, branch, or line to denote that part of the code cannot be
reasonably tested. For example, if part of your module performs a simple
<code class="docutils literal notranslate"><span class="pre">import</span></code> test of <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> and raises an error when the library is not
installed, it is not reasonable to attempt to test this and assume full
coverage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
    <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s2">&quot;Install matplotlib to use this feature.&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>You should only avoid coverage of parts of your library where you cannot
reasonably test without an extensive testing suite or setup. Most methods and
classes, including edge cases, can be reasonably tested. Even parts of your code
that raise errors like <code class="docutils literal notranslate"><span class="pre">TypeError</span></code> or <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> when users input the
wrong data type or value can be reasonably tested.</p>
</section>
<section id="code-coverage-enforcement">
<h3>Code coverage enforcement<a class="headerlink" href="#code-coverage-enforcement" title="Permalink to this headline">#</a></h3>
<p>One way of enforcing unit test coverage with a project on GitHub is to use
<code class="docutils literal notranslate"><span class="pre">codecov.io</span></code> to enforce minimum patch (and optionally project) coverage. Because
this app is already available to the <a class="reference external" href="https://github.com/pyansys">PyAnsys Organization</a>, you can simply add a <code class="docutils literal notranslate"><span class="pre">codecov.yml</span></code> file to the root
directory of your repository. This example file provides a sample configuration:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">comment</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">layout</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;diff&quot;</span><span class="w"></span>
<span class="w">  </span><span class="nt">behavior</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span><span class="w"></span>

<span class="nt">coverage</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">status</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">project</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">default</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="c1"># basic</span><span class="w"></span>
<span class="w">        </span><span class="c1"># target: 50%</span><span class="w"></span>
<span class="w">        </span><span class="nt">threshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0%</span><span class="w"></span>
<span class="w">        </span><span class="c1"># advanced</span><span class="w"></span>
<span class="w">        </span><span class="nt">if_not_found</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">success</span><span class="w"></span>
<span class="w">        </span><span class="nt">if_ci_failed</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">error</span><span class="w"></span>
<span class="w">        </span><span class="nt">if_no_uploads</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">error</span><span class="w"></span>
<span class="w">    </span><span class="nt">patch</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">default</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="c1"># basic</span><span class="w"></span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">90%</span><span class="w"></span>
<span class="w">        </span><span class="nt">if_not_found</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">success</span><span class="w"></span>
<span class="w">        </span><span class="nt">if_ci_failed</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">error</span><span class="w"></span>
<span class="w">        </span><span class="nt">if_no_uploads</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">error</span><span class="w"></span>
</pre></div>
</div>
<p>Using a <code class="docutils literal notranslate"><span class="pre">codecov.yml</span></code> file requires that each PR has a patch coverage of 90%, meaning that 90% of any
source added to the repository (unless ignored) must be covered by unit tests.</p>
</section>
</section>
<section id="testing-using-github-actions">
<h2>Testing using GitHub Actions<a class="headerlink" href="#testing-using-github-actions" title="Permalink to this headline">#</a></h2>
<p>Effective CI/CD assumes that unit testing is developed during feature
development or bug fixes. However, given the limited scope of the local
development environment, it is often not possible to enforce testing on
multiple platforms, or even to enforce unit testing in general. However, with the proper
automated CI/CD, such testing can still occur and be enforced automatically.</p>
<p><a class="reference external" href="https://github.com/features/actions">GitHub Actions</a> is the preferred automated CI/CD platform for running Python
library unit tests for PyAnsys. It can be used immediately by cloning the
project <a class="reference external" href="https://github.com/pyansys/template/">template</a>. If you are
unfamiliar with GitHub Actions, see <a class="reference external" href="https://github.com/features/actions">GitHub Actions</a> for an overview.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CI</span><span class="w"></span>
<span class="nt">on</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">pull_request</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">push</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">tags</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;*&quot;</span><span class="w"></span>
<span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">main</span><span class="w"></span>

<span class="nt">env</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">MAIN_PYTHON_VERSION</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3.9</span><span class="w"></span>

<span class="nt">concurrency</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ github.workflow }}-${{ github.ref }}</span><span class="w"></span>
<span class="w">  </span><span class="nt">cancel-in-progress</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>

<span class="nt">jobs</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">tests</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Tests</span><span class="w"></span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ matrix.os }}</span><span class="w"></span>
<span class="w">    </span><span class="nt">strategy</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">matrix</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">os</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">windows-latest</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">macos-latest</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">ubuntu-latest</span><span class="p p-Indicator">]</span><span class="w"></span>
<span class="w">        </span><span class="nt">python-version</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;3.7&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;3.8&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;3.9&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;3.10&quot;</span><span class="p p-Indicator">]</span><span class="w"></span>
<span class="w">      </span><span class="nt">fail-fast</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>

<span class="w">    </span><span class="nt">steps</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Checkout project</span><span class="w"></span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v2</span><span class="w"></span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Set up Python ${{ matrix.python-version }}</span><span class="w"></span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/setup-python@v2</span><span class="w"></span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="nt">python-version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ matrix.python-version }}</span><span class="w"></span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Installing dependencies</span><span class="w"></span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span><span class="w"></span>
<span class="w">          </span><span class="no">python -m pip install --upgrade pip</span><span class="w"></span>
<span class="w">          </span><span class="no">&lt;additional dependencies&gt;</span><span class="w"></span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run tests</span><span class="w"></span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span><span class="w"></span>
<span class="w">          </span><span class="no">&lt;command for running your tests&gt;</span><span class="w"></span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Upload coverage to Codecov</span><span class="w"></span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">codecov/codecov-action@v2</span><span class="w"></span>
<span class="w">        </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">matrix.python-version == ${{ env.MAIN_PYTHON_VERSION }}</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>


              </article>
              

              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright (c) 2022 ANSYS, Inc. All rights reserved.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>